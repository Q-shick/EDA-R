linetype = 2, color = 'blue') +
geom_line(stat = 'summary', fun.y = quantile, fun.args = list(probs = 0.9),
linetype = 2, color = 'blue') +
labs(title = "Mean Hourly Pay by Year", x = "Year", y = "Hourly Pay") +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_continuous(breaks = seq(1980, 2006, 1))
ggplot(hourly_pay, aes(year, hourly_pay)) +
geom_point(alpha = 1/3, color = 'red', position = position_jitter()) +
geom_smooth(method = 'lm', color = 'blue') +
labs(title = "Hourly Pay Trend", x = "Year", y = "Hourly Pay") +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_continuous(breaks = seq(1980, 2006, 1))
cor.test(hourly_pay$year, hourly_pay$hourly_pay)
hourly_pay_by_year <- hourly_pay %>%
group_by(year) %>%
summarise(hourly_pay_mean = mean(hourly_pay, na.rm = T),
hourly_pay_median = median(hourly_pay, na.rm = T)) %>%
arrange(year)
ggplot(hourly_pay_by_year, aes(year, hourly_pay_median)) +
geom_line() +
labs(title = "Median Hourly Pay", x = "Year", y = "Hourly Pay") +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_continuous(breaks = seq(1980, 2006, 1))
hourly_pay_low <- hourly_pay[hourly_pay$class == 'low', ] %>%
group_by(year) %>%
summarise(hourly_mean = mean(hourly_pay, na.rm = T)) %>%
arrange(year)
hourly_pay_low$class <- paste('low')
hourly_pay_middle <- hourly_pay[hourly_pay$class == 'middle', ] %>%
group_by(year) %>%
summarise(hourly_mean = mean(hourly_pay, na.rm = T)) %>%
arrange(year)
hourly_pay_middle$class <- paste('middle')
hourly_pay_high <- hourly_pay[hourly_pay$class == 'high', ] %>%
group_by(year) %>%
summarise(hourly_mean = mean(hourly_pay, na.rm = T)) %>%
arrange(year)
hourly_pay_high$class <- paste('high')
hourly_pay_by_class <- rbind(hourly_pay_low,
hourly_pay_middle,
hourly_pay_high)
ggplot(hourly_pay_by_class, aes(year, hourly_mean)) +
geom_line(aes(color = class)) +
labs(title = "Mean Hourly Pay by Class", x = "Year", y = "Hourly Pay") +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_continuous(breaks = seq(1980, 2006, 1))
View(hourly_pay)
View(hourly_pay)
# years column into numerical type
colnames(hourly_pay) <- c('country', 1980:2006, 'class')
hourly_pay$class <- ifelse(hourly_pay$X1997 > 20, 'high', 'middle')
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(gridExtra)
library(tidyr)
library(reshape2)
library(dplyr)
# read the data and take care of variables with irregular values
hourly_pay <- read.csv('../Data/indicator_hour compensation.csv')
hourly_pay$X <- NULL
hourly_pay <- hourly_pay[-35, ]
colnames(hourly_pay)[1] <- "country"
summary(hourly_pay$X1997)
p_1980 <- ggplot(hourly_pay, aes(X1980)) +
geom_histogram(binwidth = 3, color = 'black', fill = 'blue') +
xlab("Hourly Pay in 1980")+ ylab("Countries") +
scale_x_continuous(limits = c(0, 45), breaks = seq(0, 45, 2))
p_2006 <- ggplot(hourly_pay, aes(X2006)) +
geom_histogram(binwidth = 3, color = 'black', fill = 'blue') +
xlab("Hourly Pay in 2006") + ylab("Countries") +
scale_x_continuous(limits = c(0, 45), breaks = seq(0, 45, 2))
grid.arrange(p_1980, p_2006, ncol = 1)
hourly_pay$class <- ifelse(hourly_pay$X1997 > 20, 'high', 'middle')
hourly_pay$class <- ifelse(hourly_pay$X1997 <= 5, 'low', hourly_pay$class)
# years column into numerical type
colnames(hourly_pay) <- c('country', 1980:2006, 'class')
# new format
hourly_pay <- melt(hourly_pay, id.vars = c('country', 'class'),
variable.name = 'year', value.name = 'hourly_pay')
hourly_pay$year <- as.numeric(hourly_pay$year) + 1980
ggplot(hourly_pay, aes(year, hourly_pay)) +
geom_point(alpha = 1/3, color = 'gray', position = position_jitter()) +
geom_line(stat = 'summary', fun.y = mean, color = 'red') +
geom_line(stat = 'summary', fun.y = quantile, fun.args = list(probs = 0.1),
linetype = 2, color = 'blue') +
geom_line(stat = 'summary', fun.y = quantile, fun.args = list(probs = 0.9),
linetype = 2, color = 'blue') +
labs(title = "Mean Hourly Pay by Year", x = "Year", y = "Hourly Pay") +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_continuous(breaks = seq(1980, 2006, 1))
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(gridExtra)
library(tidyr)
library(reshape2)
library(dplyr)
# read the data and take care of variables with irregular values
hourly_pay <- read.csv('../Data/indicator_hour compensation.csv')
hourly_pay$X <- NULL
hourly_pay <- hourly_pay[-35, ]
colnames(hourly_pay)[1] <- "country"
summary(hourly_pay$X1997)
p_1980 <- ggplot(hourly_pay, aes(X1980)) +
geom_histogram(binwidth = 3, color = 'black', fill = 'blue') +
xlab("Hourly Pay in 1980")+ ylab("Countries") +
scale_x_continuous(limits = c(0, 45), breaks = seq(0, 45, 2))
p_2006 <- ggplot(hourly_pay, aes(X2006)) +
geom_histogram(binwidth = 3, color = 'black', fill = 'blue') +
xlab("Hourly Pay in 2006") + ylab("Countries") +
scale_x_continuous(limits = c(0, 45), breaks = seq(0, 45, 2))
grid.arrange(p_1980, p_2006, ncol = 1)
hourly_pay$class <- ifelse(hourly_pay$X1997 > 20, 'high', 'middle')
hourly_pay$class <- ifelse(hourly_pay$X1997 <= 5, 'low', hourly_pay$class)
# years column into numerical type
colnames(hourly_pay) <- c('country', 1980:2006, 'class')
# new format
hourly_pay <- melt(hourly_pay, id.vars = c('country', 'class'),
variable.name = 'year', value.name = 'hourly_pay')
hourly_pay$year <- as.numeric(hourly_pay$year) + 1980
ggplot(hourly_pay, aes(year, hourly_pay)) +
geom_point(alpha = 1/3, color = 'black', position = position_jitter()) +
geom_line(stat = 'summary', fun.y = mean, color = 'red') +
geom_line(stat = 'summary', fun.y = quantile, fun.args = list(probs = 0.1),
linetype = 2, color = 'blue') +
geom_line(stat = 'summary', fun.y = quantile, fun.args = list(probs = 0.9),
linetype = 2, color = 'blue') +
labs(title = "Mean Hourly Pay by Year", x = "Year", y = "Hourly Pay") +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_continuous(breaks = seq(1980, 2006, 1))
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(gridExtra)
library(tidyr)
library(reshape2)
library(dplyr)
# read the data and take care of variables with irregular values
hourly_pay <- read.csv('../Data/indicator_hour compensation.csv')
hourly_pay$X <- NULL
hourly_pay <- hourly_pay[-35, ]
colnames(hourly_pay)[1] <- "country"
summary(hourly_pay$X1997)
p_1980 <- ggplot(hourly_pay, aes(X1980)) +
geom_histogram(binwidth = 3, color = 'black', fill = 'blue') +
xlab("Hourly Pay in 1980")+ ylab("Countries") +
scale_x_continuous(limits = c(0, 45), breaks = seq(0, 45, 2))
p_2006 <- ggplot(hourly_pay, aes(X2006)) +
geom_histogram(binwidth = 3, color = 'black', fill = 'blue') +
xlab("Hourly Pay in 2006") + ylab("Countries") +
scale_x_continuous(limits = c(0, 45), breaks = seq(0, 45, 2))
grid.arrange(p_1980, p_2006, ncol = 1)
hourly_pay$class <- ifelse(hourly_pay$X1997 > 20, 'high', 'middle')
hourly_pay$class <- ifelse(hourly_pay$X1997 <= 5, 'low', hourly_pay$class)
# years column into numerical type
colnames(hourly_pay) <- c('country', 1980:2006, 'class')
# new format
hourly_pay <- melt(hourly_pay, id.vars = c('country', 'class'),
variable.name = 'year', value.name = 'hourly_pay')
hourly_pay$year <- as.numeric(hourly_pay$year) + 1980
ggplot(hourly_pay, aes(year, hourly_pay)) +
geom_point(alpha = 1/3, color = 'red', position = position_jitter()) +
geom_line(stat = 'summary', fun.y = mean, color = 'green') +
geom_line(stat = 'summary', fun.y = quantile, fun.args = list(probs = 0.1),
linetype = 2, color = 'blue') +
geom_line(stat = 'summary', fun.y = quantile, fun.args = list(probs = 0.9),
linetype = 2, color = 'blue') +
labs(title = "Mean Hourly Pay by Year", x = "Year", y = "Hourly Pay") +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_continuous(breaks = seq(1980, 2006, 1))
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(gridExtra)
library(tidyr)
library(reshape2)
library(dplyr)
# read the data and take care of variables with irregular values
hourly_pay <- read.csv('../Data/indicator_hour compensation.csv')
hourly_pay$X <- NULL
hourly_pay <- hourly_pay[-35, ]
colnames(hourly_pay)[1] <- "country"
summary(hourly_pay$X1997)
p_1980 <- ggplot(hourly_pay, aes(X1980)) +
geom_histogram(binwidth = 3, color = 'black', fill = 'blue') +
xlab("Hourly Pay in 1980")+ ylab("Countries") +
scale_x_continuous(limits = c(0, 45), breaks = seq(0, 45, 2))
p_2006 <- ggplot(hourly_pay, aes(X2006)) +
geom_histogram(binwidth = 3, color = 'black', fill = 'blue') +
xlab("Hourly Pay in 2006") + ylab("Countries") +
scale_x_continuous(limits = c(0, 45), breaks = seq(0, 45, 2))
grid.arrange(p_1980, p_2006, ncol = 1)
hourly_pay$class <- ifelse(hourly_pay$X1997 > 20, 'high', 'middle')
hourly_pay$class <- ifelse(hourly_pay$X1997 <= 5, 'low', hourly_pay$class)
# years column into numerical type
colnames(hourly_pay) <- c('country', 1980:2006, 'class')
# new format
hourly_pay <- melt(hourly_pay, id.vars = c('country', 'class'),
variable.name = 'year', value.name = 'hourly_pay')
hourly_pay$year <- as.numeric(hourly_pay$year) + 1980
ggplot(hourly_pay, aes(year, hourly_pay)) +
geom_point(alpha = 1/3, color = 'red', position = position_jitter()) +
geom_line(stat = 'summary', fun.y = mean, color = 'green') +
geom_line(stat = 'summary', fun.y = quantile, fun.args = list(probs = 0.2),
linetype = 2, color = 'blue') +
geom_line(stat = 'summary', fun.y = quantile, fun.args = list(probs = 0.8),
linetype = 2, color = 'blue') +
labs(title = "Mean Hourly Pay by Year", x = "Year", y = "Hourly Pay") +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_continuous(breaks = seq(1980, 2006, 1))
ggplot(hourly_pay, aes(year, hourly_pay)) +
geom_point(alpha = 1/3, color = 'red', position = position_jitter()) +
geom_smooth(method = 'lm', color = 'blue') +
labs(title = "Hourly Pay Trend", x = "Year", y = "Hourly Pay") +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_continuous(breaks = seq(1980, 2006, 1))
View(hourly_pay)
hourly_pay_temp <- hourly_pay[!is.na(hourly_pay$hourly_pay), ]
cor.test(hourly_pay_temp$year, hourly_pay_temp$hour_pay)
View(hourly_pay_temp)
View(hourly_pay_temp)
cor.test(hourly_pay_temp$year, hourly_pay_temp$hourly_pay)
cor.test(hourly_pay$year, hourly_pay$hourly_pay)
cor.test(hourly_pay_temp$year, hourly_pay_temp$hourly_pay)
hourly_pay_temp <- hourly_pay[hourly_pay$year < 1995, ]
cor.test(hourly_pay_temp$year, hourly_pay_temp$hourly_pay)
hourly_pay_temp <- hourly_pay[hourly_pay$year < 1990, ]
cor.test(hourly_pay_temp$year, hourly_pay_temp$hourly_pay)
ggplot(hourly_pay, aes(year, hourly_pay)) +
geom_point(alpha = 1/3, color = 'red', position = position_jitter()) +
geom_smooth(method = 'lm', color = 'blue') +
labs(title = "Hourly Pay Trend", x = "Year", y = "Hourly Pay") +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_continuous(breaks = seq(1980, 2006, 1))
hourly_pay_temp <- hourly_pay[hourly_pay$year < 1996, ]
cor.test(hourly_pay_temp$year, hourly_pay_temp$hourly_pay)
hourly_pay_temp <- hourly_pay[hourly_pay$year > 1985 & hourly_pay$year < 1996, ]
cor.test(hourly_pay_temp$year, hourly_pay_temp$hourly_pay)
hourly_pay_temp <- hourly_pay[hourly_pay$year > 1985 & hourly_pay$year < 1998, ]
cor.test(hourly_pay_temp$year, hourly_pay_temp$hourly_pay)
cor.test(hourly_pay$year, hourly_pay$hourly_pay)
ggplot(hourly_pay_by_year, aes(x = year)) +
geom_line(aes(y = hourly_pay_mean)) +
labs(title = "Median Hourly Pay", x = "Year", y = "Hourly Pay") +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_continuous(breaks = seq(1980, 2006, 1))
ggplot(hourly_pay_by_year, aes(x = year)) +
geom_line(aes(y = hourly_pay_mean)) +
geom_line(aes(y = hourly_pay_median)) +
labs(title = "Median Hourly Pay", x = "Year", y = "Hourly Pay") +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_continuous(breaks = seq(1980, 2006, 1))
ggplot(hourly_pay_by_year, aes(x = year)) +
geom_line(aes(y = hourly_pay_mean), color = 'red') +
geom_line(aes(y = hourly_pay_median), color = 'blue') +
labs(title = "Median Hourly Pay", x = "Year", y = "Hourly Pay") +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_continuous(breaks = seq(1980, 2006, 1))
ggplot(hourly_pay_by_year, aes(x = year)) +
geom_line(aes(y = hourly_pay_mean), color = 'red') +
geom_line(aes(y = hourly_pay_median), color = 'blue') +
labs(title = "Median Hourly Pay", x = "Year", y = "Hourly Pay") +
theme(axis.text.x = element_text(angle = 90),
legend.text = element_text()) +
scale_x_continuous(breaks = seq(1980, 2006, 1))
ggplot(hourly_pay_by_year, aes(x = year)) +
geom_line(aes(y = hourly_pay_mean), color = 'red', labels("Mean")) +
geom_line(aes(y = hourly_pay_median), color = 'blue', labels("Median")) +
labs(title = "Median Hourly Pay", x = "Year", y = "Hourly Pay") +
theme(axis.text.x = element_text(angle = 90),
legend.text = element_text()) +
scale_x_continuous(breaks = seq(1980, 2006, 1))
ggplot(hourly_pay_by_year, aes(x = year)) +
geom_line(aes(y = hourly_pay_mean), color = 'red', labels="Mean") +
geom_line(aes(y = hourly_pay_median), color = 'blue', labels="Median") +
labs(title = "Median Hourly Pay", x = "Year", y = "Hourly Pay") +
theme(axis.text.x = element_text(angle = 90),
legend.text = element_text()) +
scale_x_continuous(breaks = seq(1980, 2006, 1))
ggplot(hourly_pay_by_year, aes(x = year)) +
geom_line(aes(y = hourly_pay_mean), color = 'red', labels="Mean") +
geom_line(aes(y = hourly_pay_median), color = 'blue', labels="Median") +
labs(title = "Median Hourly Pay", x = "Year", y = "Hourly Pay") +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_continuous(breaks = seq(1980, 2006, 1)) +
scale_x_discrete(name = "")
ggplot(hourly_pay_by_year, aes(x = year)) +
geom_line(aes(y = hourly_pay_mean), color = 'red', labels="Mean") +
geom_line(aes(y = hourly_pay_median), color = 'blue', labels="Median") +
labs(title = "Median Hourly Pay", x = "Year", y = "Hourly Pay") +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_continuous(breaks = seq(1980, 2006, 1)) +
scale_color_continuous(name = "", labels = c("Mean", "Median"))
ggplot(hourly_pay_by_year, aes(x = year)) +
geom_line(aes(y = hourly_pay_mean), color = 'red') +
geom_line(aes(y = hourly_pay_median), color = 'blue') +
labs(title = "Median Hourly Pay", x = "Year", y = "Hourly Pay") +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_continuous(breaks = seq(1980, 2006, 1)) +
scale_color_continuous(name = "", labels = c("Mean", "Median"))
ggplot(hourly_pay_by_year, aes(x = year)) +
geom_line(aes(y = hourly_pay_mean), color = 'red') +
geom_line(aes(y = hourly_pay_median), color = 'blue') +
labs(title = "Median Hourly Pay", x = "Year", y = "Hourly Pay") +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_continuous(breaks = seq(1980, 2006, 1)) +
scale_color_discrete(name = "", labels = c("Mean", "Median"))
hourly_pay_mean_median <- ggplot(hourly_pay_by_year, aes(x = year)) +
geom_line(aes(y = hourly_pay_mean), color = 'red') +
geom_line(aes(y = hourly_pay_median), color = 'blue') +
labs(title = "Median Hourly Pay", x = "Year", y = "Hourly Pay")
hourly_pay_mean_median + theme(axis.text.x = element_text(angle = 75)) +
scale_x_continuous(breaks = seq(1980, 2006, 1)) +
scale_color_discrete(name = "", labels = c("Mean", "Median"))
hourly_pay_mean_median + theme(axis.text.x = element_text(angle = 45)) +
scale_x_continuous(breaks = seq(1980, 2006, 1)) +
scale_color_discrete(name = "", labels = c("Mean", "Median"))
hourly_pay_mean_median + theme(axis.text.x = element_text(angle = 45)) +
scale_x_continuous(breaks = seq(1980, 2006, 1)) +
scale_color_discrete(name = "N", labels = c("Mean", "Median"))
hourly_pay_mean_median <- ggplot(hourly_pay_by_year) +
geom_line(aes(year, hourly_pay_mean, color = 'red')) +
geom_line(aes(year, hourly_pay_median, color = 'blue')) +
labs(title = "Median Hourly Pay", x = "Year", y = "Hourly Pay")
hourly_pay_mean_median + theme(axis.text.x = element_text(angle = 45)) +
scale_x_continuous(breaks = seq(1980, 2006, 1)) +
scale_color_discrete(name = "N", labels = c("Mean", "Median"))
hourly_pay_mean_median <- ggplot(hourly_pay_by_year) +
geom_line(aes(year, hourly_pay_mean, color = 'red'), size = 2) +
geom_line(aes(year, hourly_pay_median, color = 'blue'), size = 2) +
labs(title = "Median Hourly Pay", x = "Year", y = "Hourly Pay")
hourly_pay_mean_median + theme(axis.text.x = element_text(angle = 45)) +
scale_x_continuous(breaks = seq(1980, 2006, 1)) +
scale_color_discrete(name = "N", labels = c("Mean", "Median"))
hourly_pay_mean_median <- ggplot(hourly_pay_by_year) +
geom_line(aes(year, hourly_pay_mean, color = 'red'), size = 1) +
geom_line(aes(year, hourly_pay_median, color = 'blue'), size = 1) +
labs(title = "Median Hourly Pay", x = "Year", y = "Hourly Pay")
hourly_pay_mean_median + theme(axis.text.x = element_text(angle = 45)) +
scale_x_continuous(breaks = seq(1980, 2006, 1)) +
scale_color_discrete(name = "N", labels = c("Mean", "Median"))
hourly_pay_class <- ggplot(hourly_pay_by_class, aes(year, hourly_mean)) +
geom_line(aes(color = class), size = 1) +
labs(title = "Mean Hourly Pay by Class", x = "Year", y = "Hourly Pay")
hourly_pay_class + theme(axis.text.x = element_text(angle = 45)) +
scale_x_continuous(breaks = seq(1980, 2006, 1))
hourly_pay_class + theme(axis.text.x = element_text(angle = 45)) +
scale_x_continuous(breaks = seq(1980, 2006, 1)) +
scale_color_discrete(name = "Pay Class")
# mean of hourly pay <= 5 group for each year
hourly_pay_low <- hourly_pay[hourly_pay$class == '3_low', ] %>%
group_by(year) %>%
summarise(hourly_mean = mean(hourly_pay, na.rm = T)) %>%
arrange(year)
hourly_pay_low$class <- paste('low')
# mean of hourly pay <= 5 group for each year
hourly_pay_low <- hourly_pay[hourly_pay$class == '3_low', ] %>%
group_by(year) %>%
summarise(hourly_mean = mean(hourly_pay, na.rm = T)) %>%
arrange(year)
hourly_pay_low$class <- paste('3_low')
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(gridExtra)
library(tidyr)
library(reshape2)
library(dplyr)
# read the data and take care of variables with irregular values
hourly_pay <- read.csv('../Data/indicator_hour compensation.csv')
hourly_pay$X <- NULL
hourly_pay <- hourly_pay[-35, ]
colnames(hourly_pay)[1] <- "country"
summary(hourly_pay$X1997)
p_1980 <- ggplot(hourly_pay, aes(X1980)) +
geom_histogram(binwidth = 3, color = 'gray', fill = 'lightblue') +
xlab("Hourly Pay in 1980")+ ylab("Countries") +
scale_x_continuous(limits = c(0, 45), breaks = seq(0, 45, 2))
p_2006 <- ggplot(hourly_pay, aes(X2006)) +
geom_histogram(binwidth = 3, color = 'gray', fill = 'lightblue') +
xlab("Hourly Pay in 2006") + ylab("Countries") +
scale_x_continuous(limits = c(0, 45), breaks = seq(0, 45, 2))
grid.arrange(p_1980, p_2006, ncol = 1)
hourly_pay$class <- ifelse(hourly_pay$X1997 > 20, 'high', 'middle')
hourly_pay$class <- ifelse(hourly_pay$X1997 <= 5, 'low', hourly_pay$class)
# years column into numerical type
colnames(hourly_pay) <- c('country', 1980:2006, 'class')
# new format
hourly_pay <- melt(hourly_pay, id.vars = c('country', 'class'),
variable.name = 'year', value.name = 'hourly_pay')
hourly_pay$year <- as.numeric(hourly_pay$year) + 1980
# scatter plot with benchmark lines
hourly_pay_scatter <- ggplot(hourly_pay, aes(year, hourly_pay)) +
geom_point(alpha = 1/3, color = 'red', position = position_jitter()) +
geom_line(stat = 'summary', fun.y = mean, color = 'green') +
geom_line(stat = 'summary', fun.y = quantile, fun.args = list(probs = 0.2),
linetype = 2, color = 'blue') +
geom_line(stat = 'summary', fun.y = quantile, fun.args = list(probs = 0.8),
linetype = 2, color = 'blue') +
labs(title = "Mean Hourly Pay by Year", x = "Year", y = "Hourly Pay")
hourly_pay_scatter + theme(axis.text.x = element_text(angle = 45)) +
scale_x_continuous(breaks = seq(1980, 2006, 1))
# smoothing the scatter plot
hourly_pay_smooth <- ggplot(hourly_pay, aes(year, hourly_pay)) +
geom_point(alpha = 1/3, color = 'red', position = position_jitter()) +
geom_smooth(method = 'lm', color = 'blue') +
labs(title = "Hourly Pay Trend", x = "Year", y = "Hourly Pay")
hourly_pay_smooth + theme(axis.text.x = element_text(angle = 45)) +
scale_x_continuous(breaks = seq(1980, 2006, 1))
cor.test(hourly_pay$year, hourly_pay$hourly_pay)
# seek yearly mean and median
hourly_pay_by_year <- hourly_pay %>%
group_by(year) %>%
summarise(hourly_pay_mean = mean(hourly_pay, na.rm = T),
hourly_pay_median = median(hourly_pay, na.rm = T)) %>%
arrange(year)
hourly_pay_mean_median <- ggplot(hourly_pay_by_year) +
geom_line(aes(year, hourly_pay_mean, color = 'red'), size = 1) +
geom_line(aes(year, hourly_pay_median, color = 'blue'), size = 1) +
labs(title = "Median Hourly Pay", x = "Year", y = "Hourly Pay")
hourly_pay_mean_median + theme(axis.text.x = element_text(angle = 45)) +
scale_x_continuous(breaks = seq(1980, 2006, 1)) +
scale_color_discrete(name = "", labels = c("Mean", "Median"))
# mean of hourly pay <= 5 group for each year
hourly_pay_low <- hourly_pay[hourly_pay$class == '3_low', ] %>%
group_by(year) %>%
summarise(hourly_mean = mean(hourly_pay, na.rm = T)) %>%
arrange(year)
hourly_pay_low$class <- paste('3_low')
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(gridExtra)
library(tidyr)
library(reshape2)
library(dplyr)
# read the data and take care of variables with irregular values
hourly_pay <- read.csv('../Data/indicator_hour compensation.csv')
hourly_pay$X <- NULL
hourly_pay <- hourly_pay[-35, ]
colnames(hourly_pay)[1] <- "country"
summary(hourly_pay$X1997)
p_1980 <- ggplot(hourly_pay, aes(X1980)) +
geom_histogram(binwidth = 3, color = 'gray', fill = 'lightblue') +
xlab("Hourly Pay in 1980")+ ylab("Countries") +
scale_x_continuous(limits = c(0, 45), breaks = seq(0, 45, 2))
p_2006 <- ggplot(hourly_pay, aes(X2006)) +
geom_histogram(binwidth = 3, color = 'gray', fill = 'lightblue') +
xlab("Hourly Pay in 2006") + ylab("Countries") +
scale_x_continuous(limits = c(0, 45), breaks = seq(0, 45, 2))
grid.arrange(p_1980, p_2006, ncol = 1)
hourly_pay$class <- ifelse(hourly_pay$X1997 > 20, '1_high', '2_middle')
hourly_pay$class <- ifelse(hourly_pay$X1997 <= 5, '3_low', hourly_pay$class)
# years column into numerical type
colnames(hourly_pay) <- c('country', 1980:2006, 'class')
# new format
hourly_pay <- melt(hourly_pay, id.vars = c('country', 'class'),
variable.name = 'year', value.name = 'hourly_pay')
hourly_pay$year <- as.numeric(hourly_pay$year) + 1980
# scatter plot with benchmark lines
hourly_pay_scatter <- ggplot(hourly_pay, aes(year, hourly_pay)) +
geom_point(alpha = 1/3, color = 'red', position = position_jitter()) +
geom_line(stat = 'summary', fun.y = mean, color = 'green') +
geom_line(stat = 'summary', fun.y = quantile, fun.args = list(probs = 0.2),
linetype = 2, color = 'blue') +
geom_line(stat = 'summary', fun.y = quantile, fun.args = list(probs = 0.8),
linetype = 2, color = 'blue') +
labs(title = "Mean Hourly Pay by Year", x = "Year", y = "Hourly Pay")
hourly_pay_scatter + theme(axis.text.x = element_text(angle = 45)) +
scale_x_continuous(breaks = seq(1980, 2006, 1))
# smoothing the scatter plot
hourly_pay_smooth <- ggplot(hourly_pay, aes(year, hourly_pay)) +
geom_point(alpha = 1/3, color = 'red', position = position_jitter()) +
geom_smooth(method = 'lm', color = 'blue') +
labs(title = "Hourly Pay Trend", x = "Year", y = "Hourly Pay")
hourly_pay_smooth + theme(axis.text.x = element_text(angle = 45)) +
scale_x_continuous(breaks = seq(1980, 2006, 1))
cor.test(hourly_pay$year, hourly_pay$hourly_pay)
# seek yearly mean and median
hourly_pay_by_year <- hourly_pay %>%
group_by(year) %>%
summarise(hourly_pay_mean = mean(hourly_pay, na.rm = T),
hourly_pay_median = median(hourly_pay, na.rm = T)) %>%
arrange(year)
hourly_pay_mean_median <- ggplot(hourly_pay_by_year) +
geom_line(aes(year, hourly_pay_mean, color = 'red'), size = 1) +
geom_line(aes(year, hourly_pay_median, color = 'blue'), size = 1) +
labs(title = "Median Hourly Pay", x = "Year", y = "Hourly Pay")
hourly_pay_mean_median + theme(axis.text.x = element_text(angle = 45)) +
scale_x_continuous(breaks = seq(1980, 2006, 1)) +
scale_color_discrete(name = "", labels = c("Mean", "Median"))
# mean of hourly pay <= 5 group for each year
hourly_pay_low <- hourly_pay[hourly_pay$class == '3_low', ] %>%
group_by(year) %>%
summarise(hourly_mean = mean(hourly_pay, na.rm = T)) %>%
arrange(year)
hourly_pay_low$class <- paste('3_low')
# mean of 5 < hourly pay <= 20 group for each year
hourly_pay_middle <- hourly_pay[hourly_pay$class == '2_middle', ] %>%
group_by(year) %>%
summarise(hourly_mean = mean(hourly_pay, na.rm = T)) %>%
arrange(year)
hourly_pay_middle$class <- paste('2_middle')
# mean of 20 < hourly pay group for each year
hourly_pay_high <- hourly_pay[hourly_pay$class == '1_high', ] %>%
group_by(year) %>%
summarise(hourly_mean = mean(hourly_pay, na.rm = T)) %>%
arrange(year)
hourly_pay_high$class <- paste('1_high')
# into one data frame for plotting
hourly_pay_by_class <- rbind(hourly_pay_low, hourly_pay_middle, hourly_pay_high)
hourly_pay_class <- ggplot(hourly_pay_by_class, aes(year, hourly_mean)) +
geom_line(aes(color = class), size = 1) +
labs(title = "Mean Hourly Pay by Class", x = "Year", y = "Hourly Pay")
hourly_pay_class + theme(axis.text.x = element_text(angle = 45)) +
scale_x_continuous(breaks = seq(1980, 2006, 1)) +
scale_color_discrete(name = "Pay Class", labels = c("High", "Middle", "Low"))
