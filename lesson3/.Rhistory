heart_mortality <- heart_mortality[!is.na(heart_mortality$Data_Value), ]
# change column names
colnames(heart_mortality) <- c('state', 'county', 'mortality',
'gender', 'race', 'location')
# process the regional columns
heart_mortality <- process_region(heart_mortality, state.abb)
# convert location to x, y coordinate format
loc_split <- strsplit(as.character(heart_mortality$location), split = " ")
heart_mortality$x <- parse_number(sapply(loc_split, '[', 1))
heart_mortality$y <- parse_number(sapply(loc_split, '[', 2))
# show structure
str(heart_mortality)
# load farmer's market data set
farmers_market <- read.csv('../Data/Farmers_Markets_by_County.csv')
# select columns
farmers_market <- farmers_market[, -c(1:9, 12:20, 23, 59)]
farmers_market <- farmers_market[, c(1:4, 11, 17:18, 24, 32:33)]
farmers_market <- farmers_market[farmers_market$County != "", ]
farmers_market <- farmers_market[!is.na(farmers_market$x), ]
# change column names
colnames(farmers_market)[1:2] <- c('county', 'state')
# process the regional columns
farmers_market <- process_region(farmers_market, state.name)
# show the structure
str(farmers_market)
View(loc_split)
View(loc_split)
heart_mortality <- heart_mortality[, -6]
heart_mortality[heart_mortality$gender == "Overall" & heart_mortality$race == "Overall"]
heart_mortality[, (heart_mortality$gender == "Overall" & heart_mortality$race == "Overall")]
heart_mortality[, (heart_mortality$gender == "Overall") & (heart_mortality$race == "Overall")]
heart_mortality[(heart_mortality$gender == "Overall") & (heart_mortality$race == "Overall"), ]
# extract "Overall" condition only
heart_mortality <- heart_mortality[(heart_mortality$gender == "Overall")
& (heart_mortality$race == "Overall"), ]
# load packages
library(ggplot2)
library(stringi)
library(readr)
# modify state names to fit a format
process_region <- function(df, state_list) {
# modify county values
df$county <- gsub("County", "", df$county)
df$county <- stri_trans_totitle(df$county)
df$county <- trimws(df$county)
# modify the mainland states and DC
df$state <- state.abb[match(df$state, state_list)]
df$state[which(df$county == "District Of Columbia")] <- "DC"
df$state <- factor(df$state)
# drop the data that is out of criteria (ex. abnormal NA's, non-US locations)
df <- df[complete.cases(df), ]
# return the final data frame
return(df)
}
# load heart disease mortality data
heart_mortality <- read.csv('../Data/Heart_Disease_Mortality_by_County.csv')
# select columns
heart_mortality <- subset(heart_mortality, GeographicLevel == 'County')
heart_mortality <- heart_mortality[, -c(1, 4:7, 9:13, 15, 17:18)]
heart_mortality <- heart_mortality[!is.na(heart_mortality$Data_Value), ]
# change column names
colnames(heart_mortality) <- c('state', 'county', 'mortality',
'gender', 'race', 'location')
# process the regional columns
heart_mortality <- process_region(heart_mortality, state.abb)
# convert location to x, y coordinate format
loc_split <- strsplit(as.character(heart_mortality$location), split = " ")
heart_mortality$x <- parse_number(sapply(loc_split, '[', 1))
heart_mortality$y <- parse_number(sapply(loc_split, '[', 2))
heart_mortality <- heart_mortality[, -6]
# extract "Overall" condition only
heart_mortality <- heart_mortality[(heart_mortality$gender == "Overall")
& (heart_mortality$race == "Overall"), ]
heart_mortality <- heart_mortality[, -c(4, 5)]
# show structure
str(heart_mortality)
# load farmer's market data set
farmers_market <- read.csv('../Data/Farmers_Markets_by_County.csv')
# select columns
farmers_market <- farmers_market[, -c(1:9, 12:20, 23, 59)]
farmers_market <- farmers_market[, c(1:4, 11, 17:18, 24, 32:33)]
farmers_market <- farmers_market[farmers_market$County != "", ]
farmers_market <- farmers_market[!is.na(farmers_market$x), ]
# change column names
colnames(farmers_market)[1:2] <- c('county', 'state')
# process the regional columns
farmers_market <- process_region(farmers_market, state.name)
# show the structure
str(farmers_market)
heart_disease_overall_hist <- ggplot(heart_mortality, aes(mortality)) +
geom_histogram()
heart_disease_overall_hist
heart_disease_overall_hist <- ggplot(heart_mortality, aes(mortality)) +
geom_histogram(binwidth = 10)
heart_disease_overall_hist
heart_disease_overall_hist <- ggplot(heart_mortality, aes(mortality)) +
geom_histogram(binwidth = 20, fill = 'lightblue')
heart_disease_overall_hist
heart_disease_overall_hist <- ggplot(heart_mortality, aes(mortality)) +
geom_histogram(binwidth = 20, color = 'gray', fill = 'lightblue') +
ggtitle("Heart Disease Mortality in the US (2014)") +
xlab("Number of Death per 100,000") +
ylab("Counties")
heart_disease_overall_hist
heart_disease_overall_hist <- ggplot(heart_mortality, aes(mortality)) +
geom_histogram(binwidth = 20, color = 'gray', fill = 'lightblue') +
ggtitle("Heart Disease Mortality in the US (2014)") +
xlab("Number of Death per 100,000") +
ylab("Counties") +
scale_x_continuous(limits = c(0, 700), breaks = seq(0, 700, 100))
heart_disease_overall_hist <- ggplot(heart_mortality, aes(mortality)) +
geom_histogram(binwidth = 20, color = 'gray', fill = 'lightblue') +
ggtitle("Heart Disease Mortality in the US (2014)") +
xlab("Number of Death per 100,000") +
ylab("Counties") +
scale_x_continuous(limits = c(0, 700), breaks = seq(0, 700, 100))
heart_disease_overall_hist
heart_disease_overall_hist <- ggplot(heart_mortality, aes(mortality)) +
geom_histogram(binwidth = 20, color = 'gray', fill = 'lightblue') +
ggtitle("Heart Disease Mortality in the US (2014)") +
xlab("Number of Death per 100,000") +
ylab("Counties") +
scale_x_continuous(limits = c(0, 700), breaks = seq(0, 700, 100))
heart_disease_overall_hist
heart_disease_overall_hist <- ggplot(heart_mortality, aes(mortality)) +
geom_histogram(binwidth = 20, color = 'gray', fill = 'lightblue') +
ggtitle("Heart Disease Mortality in the US (2014)") +
xlab("Number of Deaths per 100,000") + ylab("") +
scale_x_continuous(limits = c(0, 700), breaks = seq(0, 700, 100))
heart_disease_overall_hist
mortality_by_state <- heart_mortality %>%
group_by(state) %>%
summarise(mortality_by_mean = mean(mortality)) %>%
arrange(state)
heart_disease_state_bar <- barplot(mortality_by_state, aes(mortality_by_mean))
View(mortality_by_state)
View(mortality_by_state)
heart_disease_state_bar <- barplot(table(mortality_by_state$state), aes(mortality_by_mean))
heart_disease_state_bar <- barplot(mortality_by_state, aes(state, mortality)) +
geom_bar(color = 'gray')
heart_disease_state_bar <- ggplot(mortality_by_state, aes(state, mortality)) +
geom_bar(color = 'gray')
heart_disease_state_bar
mortality_by_state <- heart_mortality %>%
group_by(state) %>%
summarise(mortality_by_mean = mean(mortality)) %>%
arrange(state)
heart_disease_state_bar <- ggplot(mortality_by_state, aes(state, mortality_by_mean)) +
geom_bar(color = 'gray')
heart_disease_state_bar
mortality_by_state <- heart_mortality %>%
group_by(state) %>%
summarise(mortality_by_mean = mean(mortality)) %>%
arrange(state)
heart_disease_state_bar <- ggplot(mortality_by_state, aes(state, mortality_by_mean)) +
geom_bar(color = 'gray', stat = 'identity')
heart_disease_state_bar
mortality_by_state <- heart_mortality %>%
group_by(state) %>%
summarise(mortality_by_mean = mean(mortality)) %>%
arrange(mortality_by_mean)
heart_disease_state_bar <- ggplot(mortality_by_state, aes(state, mortality_by_mean)) +
geom_bar(color = 'gray', fill = 'lightgreen', stat = 'identity')
heart_disease_state_bar
library(gridExtra)
mortality_by_state <- heart_mortality %>%
group_by(state) %>%
summarise(mortality_by_mean = mean(mortality)) %>%
arrange(state)
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_state), mortality_by_mean)) +
geom_bar(color = 'gray', fill = 'lightgreen', stat = 'identity')
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, mortality_by_state), mortality_by_mean)) +
geom_bar(color = 'gray', fill = 'lightgreen', stat = 'identity')
heart_disease_state_bar
View(mortality_by_state)
mortality_by_state <- heart_mortality %>%
group_by(state) %>%
summarise(mortality_by_mean = mean(mortality)) %>%
arrange(state)
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean), mortality_by_mean)) +
geom_bar(color = 'gray', fill = 'lightgreen', stat = 'identity')
heart_disease_state_bar
data(state.region)
data(state.regions)
midwest
North_East <- c("CT","ME","MA","NH","RI","VT","NJ","NY","PA")
Mid_West <- c("IN","IL","MI","OH","WI","IA","KS","MN","MO","NE","ND","SD")
South <- c("DE","DC","FL","GA","MD","NC","SC","VA","WV","AL",
"KY","MS","TN","AR","LA","OK","TX")
West <- c("AZ","CO","ID","NM","MT","UT","NV","WY","CA","OR","WA")
Pacific <- c("AK","HI")
region_list <- list(North_East, Mid_West, South, West, Pacific)
?sapply
mortality_by_state$region <- sapply(mortality_by_state$state,
function(x) names(region_list)[grep(x, region_list)])
mortality_by_state$region <- sapply(mortality_by_state$state,
function(x) grep(x, region_list))
names(region_list)
region_list
region_list[1]
names(region_list[1])
names(region_list[[1]])
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean),
color = region) +
geom_bar(color = 'gray', fill = 'lightgreen', stat = 'identity')
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean, color = region)) +
geom_bar(color = 'gray', fill = 'lightgreen', stat = 'identity')
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean)) +
geom_bar(aes(color = region), fill = 'lightgreen', stat = 'identity')
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean)) +
geom_bar(aes(color = region), stat = 'identity')
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean)) +
geom_bar(aes(fill = region), stat = 'identity')
heart_disease_state_bar
region_list[[1]]
names(region_list)
names(region_list) <- names("NE", "MW", "South", "West", "Pac")
names(region_list) <- names(c("NE", "MW", "South", "West", "Pac"))
names(region_list)
some_list <- list(a=b, c=d)
a = 1
b = 2
some_list <- list(a=2, b=3)
some_list
rm(some_list)
rm(a, b)
rm(Mid_West, North_East, South, West, Pacific)
NE <- c("CT","ME","MA","NH","RI","VT","NJ","NY","PA")
MW <- c("IN","IL","MI","OH","WI","IA","KS","MN","MO","NE","ND","SD")
SO <- c("DE","DC","FL","GA","MD","NC","SC","VA","WV","AL",
"KY","MS","TN","AR","LA","OK","TX")
WE <- c("AZ","CO","ID","NM","MT","UT","NV","WY","CA","OR","WA")
PAC <- c("AK","HI")
region_list <- list(Northeast = NE, Midwest = MW, South = SO,
West = WE, Pacific = PAC)
names(region_list)
region_list[1]
names(region_list[1])
mortality_by_state$region <- sapply(mortality_by_state$state,
function(x) region_list[grep(x, region_list)])
mortality_by_state$region <- sapply(mortality_by_state$state, function(x)
names(region_list)[grep(x, region_list)])
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean)) +
geom_bar(aes(fill = region), stat = 'identity')
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean)) +
geom_bar(aes(fill = region), stat = 'identity') +
ggtitle("Mean Mortality by State") +
xlab("State") + ylab("Mortality") +
theme(axis.text.x = element_text(angle = 90))
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean)) +
geom_bar(aes(fill = region), stat = 'identity') +
ggtitle("Mean Mortality by State") +
xlab("State") + ylab("Mortality") +
theme(axis.text.x = element_text(size = 8, angle = 90))
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean)) +
geom_bar(aes(fill = region), stat = 'identity', width = 5) +
ggtitle("Mean Mortality by State") +
xlab("State") + ylab("Mortality") +
theme(axis.text.x = element_text(size = 5, angle = 45))
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean)) +
geom_bar(aes(fill = region), stat = 'identity', width = 1) +
ggtitle("Mean Mortality by State") +
xlab("State") + ylab("Mortality") +
theme(axis.text.x = element_text(size = 5, angle = 45))
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean)) +
geom_bar(aes(fill = region), stat = 'identity', width = 0.5) +
ggtitle("Mean Mortality by State") +
xlab("State") + ylab("Mortality") +
theme(axis.text.x = element_text(size = 6, angle = 45))
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean)) +
geom_bar(aes(fill = region), stat = 'identity', width = 0.5) +
ggtitle("Mean Mortality by State") +
xlab("State") + ylab("Mortality") +
theme(axis.text.x = element_text(size = 6, angle = 75))
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean)) +
geom_bar(aes(fill = region), stat = 'identity', width = 0.5) +
ggtitle("Mean Mortality by State") +
xlab("State") + ylab("Mortality") +
theme(axis.text.x = element_text(size = 6, angle = 75)) + theme_bw()
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean)) +
geom_bar(aes(fill = region), stat = 'identity', width = 0.5) +
ggtitle("Mean Mortality by State") +
xlab("State") + ylab("Mortality") +
theme_bw() + theme(axis.text.x = element_text(size = 6, angle = 75))
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean)) +
geom_bar(aes(fill = region), stat = 'identity', width = 0.5) +
ggtitle("Mean Mortality by State") +
xlab("State") + ylab("Mortality") +
theme_bw() + theme(axis.text.x = element_text(size = 6, angle = 75)) +
scale_fill_discrete(name = "Region")
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean)) +
geom_bar(aes(fill = region), stat = 'identity', width = 0.5) +
ggtitle("Mean Mortality by State") +
xlab("State") + ylab("Mortality") +
theme_bw() + theme(axis.text.x = element_text(size = 6, angle = 75),
legend.title = element_text(size = 10))
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean,
fill = region)) +
geom_bar(stat = 'identity', width = 0.5) +
ggtitle("Mean Mortality by State") +
xlab("State") + ylab("Mortality") +
theme_bw() + theme(axis.text.x = element_text(size = 6, angle = 75),
legend.title = element_text(size = 10)) +
scale_fill_discrete(name = "Region")
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean,
fill = region)) +
geom_bar(stat = 'identity', width = 0.5) +
ggtitle("Mean Mortality by State") +
xlab("State") + ylab("Mortality") +
theme_bw() + theme(axis.text.x = element_text(size = 6, angle = 75),
legend.title = element_text(size = 10),
legend.position = c(1,1))
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean,
fill = region)) +
geom_bar(stat = 'identity', width = 0.5) +
ggtitle("Mean Mortality by State") +
xlab("State") + ylab("Mortality") +
theme_bw() + theme(axis.text.x = element_text(size = 6, angle = 75),
legend.title = element_text(size = 10),
legend.justification = c(0,0), legend.position = c(1,1))
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean,
fill = region)) +
geom_bar(stat = 'identity', width = 0.5) +
ggtitle("Mean Mortality by State") +
xlab("State") + ylab("Mortality") +
theme_bw() + theme(axis.text.x = element_text(size = 6, angle = 75),
legend.title = element_text(size = 10),
legend.position = c(1,1))
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean,
fill = region)) +
geom_bar(stat = 'identity', width = 0.5) +
ggtitle("Mean Mortality by State") +
xlab("State") + ylab("Mortality") +
theme_bw() + theme(axis.text.x = element_text(size = 6, angle = 75),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8),
legend.position = c(0.8,0.8))
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean,
fill = region)) +
geom_bar(stat = 'identity', width = 0.5) +
ggtitle("Mean Mortality by State") +
xlab("State") + ylab("Mortality") +
theme_bw() + theme(axis.text.x = element_text(size = 6, angle = 75),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8),
legend.position = c(0.9,0.7))
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean,
fill = region)) +
geom_bar(stat = 'identity', width = 0.5) +
ggtitle("Mean Mortality by State") +
xlab("State") + ylab("Mortality") +
theme_bw() + theme(axis.text.x = element_text(size = 6, angle = 75),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8),
legend.position = c(0.9,0.75))
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean,
fill = region)) +
geom_bar(stat = 'identity', width = 0.5) +
ggtitle("Mean Mortality by State") +
xlab("State") + ylab("Mortality") +
theme_bw() + theme(axis.text.x = element_text(size = 6, angle = 75),
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.position = c(0.95,0.75))
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean,
fill = region)) +
geom_bar(stat = 'identity', width = 0.5) +
ggtitle("Mean Mortality by State") +
xlab("State") + ylab("Mortality") +
theme_bw() + theme(axis.text.x = element_text(size = 6, angle = 75),
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.position = c(0.9,0.8))
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean,
fill = region)) +
geom_bar(stat = 'identity', width = 0.5) +
ggtitle("Mean Mortality by State") +
xlab("State") + ylab("Mortality") +
theme_bw() + theme(axis.text.x = element_text(size = 6, angle = 75),
legend.title = element_blank(),
legend.text = element_text(size = 1),
legend.position = c(0.9,0.8))
heart_disease_state_bar
heart_disease_state_bar <- ggplot(mortality_by_state,
aes(reorder(state, -mortality_by_mean),
mortality_by_mean,
fill = region)) +
geom_bar(stat = 'identity', width = 0.5) +
ggtitle("Mean Mortality by State") +
xlab("State") + ylab("Mortality")
#
heart_disease_state_bar + theme_bw() +
theme(axis.text.x = element_text(size = 6, angle = 75),
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.position = c(0.9,0.8))
heart_disease_state_bar + theme_bw() +
theme(axis.text.x = element_text(size = 6, angle = 75),
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.position = c(0.9,0.8),
legend.background = element_rect(fill = alpha('white', 0)))
heart_disease_state_bar + theme_bw() +
theme(axis.text.x = element_text(size = 6, angle = 75),
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.position = c(0.9,0.85),
legend.background = element_rect(fill = alpha('white', 0)))
heart_disease_state_bar + theme_bw() +
theme(axis.text.x = element_text(size = 6, angle = 75),
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.position = c(0.95,0.8),
legend.background = element_rect(fill = alpha('white', 0)))
heart_disease_state_bar + theme_bw() +
theme(axis.text.x = element_text(size = 6, angle = 75),
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.position = c(0.9,0.8),
legend.background = element_rect(fill = alpha('white', 0)))
heart_disease_state_bar + theme_bw() +
theme(axis.text.x = element_text(size = 6, angle = 75),
legend.title = element_blank(),
legend.text = element_text(size = 10),
legend.position = c(0.9,0.8),
legend.background = element_rect(fill = alpha('white', 0)))
heart_disease_state_bar + theme_bw() +
theme(axis.text.x = element_text(size = 7, angle = 75),
legend.title = element_blank(),
legend.text = element_text(size = 10),
legend.position = c(0.9,0.8),
legend.background = element_rect(fill = alpha('white', 0)))
